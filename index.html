<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunflower Clockulator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Sunflower Aesthetic Colors */
        :root {
            --color-petal-yellow: #facc15; /* Amber-400 (Petal/Number) */
            --color-seed-brown: #713f12; /* Amber-900 (Utility) */
            --color-accent-green: #34d399; /* Emerald-400 (Operators/Hands) */
            --color-text-dark: #1f2937; /* Gray-800 */
            --color-inactive-gray: #4b5563; /* Darker Gray for 10 and 11 */
        }

        /* Base Body and Container Styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fefce8; /* Lightest yellow, like sunshine */
        }
        .calculator-container {
            width: 450px; 
            box-shadow: 0 20px 40px -15px rgba(0, 0, 0, 0.3);
            background-color: #fff;
            padding-bottom: 24px;
            border-radius: 2rem;
        }

        /* --- Flower Assembly (Main Clock/Keypad Area) --- */
        #flower-assembly {
            width: 400px;
            height: 400px;
            position: relative;
            margin: 20px auto;
            border-radius: 50%;
            background-color: #fff;
            border: 8px solid var(--color-seed-brown);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* Style for all buttons (shared base) */
        .flower-button {
            position: absolute; 
            border-radius: 9999px; /* Full circle for the petal look */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            font-weight: 700;
            transition: transform 0.15s ease, box-shadow 0.15s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            border: 3px solid rgba(255, 255, 255, 0.6);
            z-index: 10; /* Below the hands */
        }

        .flower-button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* Active Number Petals (0-9) */
        .petal-active {
            width: 65px;
            height: 65px;
            background-color: var(--color-petal-yellow);
            color: var(--color-text-dark);
        }

        /* Inactive Clock Numbers (10, 11) */
        .petal-inactive {
            width: 65px;
            height: 65px;
            background-color: var(--color-inactive-gray);
            color: white;
            cursor: default;
            font-size: 1rem;
        }
        .petal-inactive:active {
            transform: scale(1); /* No scale effect */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* --- Clock Hand Styling (Z-index 20+) --- */
        .hand {
            position: absolute;
            left: 50%;
            bottom: 50%;
            transform-origin: 50% 100%;
            border-radius: 5px;
            z-index: 20; 
            transition: transform 0.1s cubic-bezier(0.19, 1, 0.22, 1);
        }
        #second-hand {
            width: 2px;
            height: 40%;
            background-color: var(--color-accent-green);
        }
        #minute-hand {
            width: 4px;
            height: 35%;
            background-color: var(--color-seed-brown);
        }
        #hour-hand {
            width: 6px;
            height: 25%;
            background-color: var(--color-text-dark);
        }
        /* Center Pin */
        #center-pin {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: var(--color-accent-green);
            z-index: 30;
        }

        /* --- Center Seed Keypad (Fixed 4x3 grid) --- */
        #seed-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 240px; /* Slightly larger for better spacing */
            height: 240px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            padding: 20px;
            border-radius: 9999px;
            background-color: #a16207; 
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
            z-index: 15; /* Above petals, below hands */
        }

        .seed-button {
            height: 45px;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: transform 0.15s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            font-size: 1.2rem;
        }
        .seed-button:active {
            transform: scale(0.95);
        }

        /* Coloring for Seed Buttons */
        .seed-op { background-color: var(--color-accent-green); color: white; font-size: 1.5rem; }
        .seed-util { background-color: var(--color-seed-brown); color: white; }

        /* --- Petal (Clock Marker) Positioning --- */
        
        #flower-assembly .flower-button {
            left: 50%; 
            top: 50%; 
            margin-left: -32.5px; 
            margin-top: -32.5px; 
            transform-origin: 50% 50%; 
        }

        /* 12 elements * 30 degrees = 360 degrees. Radius 170px */
        /* Buttons start at nth-child(6) due to the hands and center disc being the first 5 children. */
        
        /* 12 o'clock position (Now '0'): nth-child(6) */
        #flower-assembly .flower-button:nth-child(6) { transform: rotate(270deg) translate(170px) rotate(-270deg); } 
        /* 1 o'clock: nth-child(7) */
        #flower-assembly .flower-button:nth-child(7) { transform: rotate(300deg) translate(170px) rotate(-300deg); } 
        /* 2 o'clock: nth-child(8) */
        #flower-assembly .flower-button:nth-child(8) { transform: rotate(330deg) translate(170px) rotate(-330deg); } 
        /* 3 o'clock: nth-child(9) */
        #flower-assembly .flower-button:nth-child(9) { transform: rotate(0deg) translate(170px) rotate(0deg); } 
        /* 4 o'clock: nth-child(10) */
        #flower-assembly .flower-button:nth-child(10) { transform: rotate(30deg) translate(170px) rotate(-30deg); } 
        /* 5 o'clock: nth-child(11) */
        #flower-assembly .flower-button:nth-child(11) { transform: rotate(60deg) translate(170px) rotate(-60deg); } 
        /* 6 o'clock: nth-child(12) */
        #flower-assembly .flower-button:nth-child(12) { transform: rotate(90deg) translate(170px) rotate(-90deg); } 
        /* 7 o'clock: nth-child(13) */
        #flower-assembly .flower-button:nth-child(13) { transform: rotate(120deg) translate(170px) rotate(-120deg); } 
        /* 8 o'clock: nth-child(14) */
        #flower-assembly .flower-button:nth-child(14) { transform: rotate(150deg) translate(170px) rotate(-150deg); } 
        /* 9 o'clock: nth-child(15) */
        #flower-assembly .flower-button:nth-child(15) { transform: rotate(180deg) translate(170px) rotate(-180deg); } 
        /* 10 o'clock (Inactive): nth-child(16) */
        #flower-assembly .flower-button:nth-child(16) { transform: rotate(210deg) translate(170px) rotate(-210deg); } 
        /* 11 o'clock (Inactive): nth-child(17) */
        #flower-assembly .flower-button:nth-child(17) { transform: rotate(240deg) translate(170px) rotate(-240deg); } 

    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Calculator Container -->
    <div id="calculator" class="calculator-container bg-white rounded-3xl p-6 flex flex-col items-center">
        <h1 class="text-3xl font-extrabold text-center text-green-700">Sunflower Clockulator</h1>
        
        <!-- Display Area -->
        <div id="display" class="bg-gray-100 p-4 mt-3 rounded-xl text-right overflow-x-auto shadow-inner w-full h-24 flex flex-col justify-end relative">
            <!-- Digital Clock Display -->
            <div id="clock-display" class="text-xl font-bold text-green-700 absolute top-2 left-4">--:--:--</div>

            <div id="expression-output" class="text-sm text-gray-500 h-6"></div>
            <div id="current-value" class="text-4xl font-light text-gray-800 tracking-tight">0</div>
        </div>

        <!-- Main Flower Assembly (Clock Face + Keypad Ring + Center Keypad) -->
        <div id="flower-assembly">

            <!-- CLOCK HANDS (Children 1, 2, 3) -->
            <div id="hour-hand" class="hand"></div>
            <div id="minute-hand" class="hand"></div>
            <div id="second-hand" class="hand"></div>
            <div id="center-pin"></div> <!-- Child 4 -->


            <!-- CENTER DISC KEYPAD (Child 5) -->
            <div id="seed-center">
                <!-- Row 1: Utility & Operator -->
                <button onclick="clearDisplay()" class="seed-button seed-util">C</button>
                <button onclick="backspace()" class="seed-button seed-util">&larr;</button>
                <button onclick="press('/')" class="seed-button seed-op">/</button>

                <!-- Row 2: Operators -->
                <button onclick="press('*')" class="seed-button seed-op">*</button>
                <button onclick="press('-')" class="seed-button seed-op">-</button>
                <button onclick="press('+')" class="seed-button seed-op">+</button>

                <!-- Row 3: Decimal and Parentheses -->
                <button onclick="press('.')" class="seed-button seed-util">.</button>
                <button onclick="press('(')" class="seed-button seed-util">(</button>
                <button onclick="press(')')" class="seed-button seed-util">)</button>

                <!-- Row 4: Equals (Spans 3 columns) -->
                <button onclick="equals()" class="seed-button seed-op" style="grid-column: span 3 / span 3;">=</button>
            </div>


            <!-- OUTER PETAL RING (Starts at Child 6) -->
            <!-- Button Order (Sequential from 0 to 11, clockwise) -->
            <!-- 12 o'clock position is now 0 (Active) -->
            <button onclick="press('0')" class="flower-button petal-active">0</button> 
            <!-- 1-9 remain active and in their place -->
            <button onclick="press('1')" class="flower-button petal-active">1</button>
            <button onclick="press('2')" class="flower-button petal-active">2</button>
            <button onclick="press('3')" class="flower-button petal-active">3</button>
            <button onclick="press('4')" class="flower-button petal-active">4</button>
            <button onclick="press('5')" class="flower-button petal-active">5</button>
            <button onclick="press('6')" class="flower-button petal-active">6</button>
            <button onclick="press('7')" class="flower-button petal-active">7</button>
            <button onclick="press('8')" class="flower-button petal-active">8</button>
            <button onclick="press('9')" class="flower-button petal-active">9</button>
            <!-- 10 and 11 are INACTIVE/gray clock markers -->
            <button class="flower-button petal-inactive">10</button>
            <button class="flower-button petal-inactive">11</button>

        </div>

        <!-- Custom Modal for Errors (to replace alert()) -->
        <div id="error-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4">
            <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full">
                <h2 class="text-xl font-bold text-red-600 mb-3">Wilted Calculation!</h2>
                <p id="error-message" class="text-gray-700 mb-4"></p>
                <button onclick="hideErrorModal()" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition">Okay, Reset</button>
            </div>
        </div>

    </div>

    <script>
        // DOM Elements
        const currentValueElement = document.getElementById('current-value');
        const expressionOutputElement = document.getElementById('expression-output');
        const clockDisplayElement = document.getElementById('clock-display');
        const errorModal = document.getElementById('error-modal');
        const errorMessageElement = document.getElementById('error-message');
        
        // Clock Hand Elements
        const hourHand = document.getElementById('hour-hand');
        const minuteHand = document.getElementById('minute-hand');
        const secondHand = document.getElementById('second-hand');
        
        let expression = "";

        // --- CLOCK LOGIC ---

        /**
         * Updates both the digital and analog clocks.
         */
        function updateTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const seconds = now.getSeconds();

            // Digital Clock
            const paddedHours = String(hours).padStart(2, '0');
            const paddedMinutes = String(minutes).padStart(2, '0');
            const paddedSeconds = String(seconds).padStart(2, '0');
            clockDisplayElement.textContent = `${paddedHours}:${paddedMinutes}:${paddedSeconds}`;

            // Analog Clock Hand Rotations:
            // IMPORTANT FIX: Removed the incorrect + 270 degree offset. 
            // 0 degrees rotation is now correctly the 12 o'clock position (straight up).
            
            // Second Hand: 6 degrees per second ($360 / 60$)
            const secondsDegrees = (seconds / 60) * 360; 
            secondHand.style.transform = `rotate(${secondsDegrees}deg)`;

            // Minute Hand: 6 degrees per minute, plus proportional seconds ($360 / 60$)
            const minutesDegrees = ((minutes / 60) * 360) + ((seconds/60)*6);
            minuteHand.style.transform = `rotate(${minutesDegrees}deg)`;

            // Hour Hand: 30 degrees per hour, plus proportional minutes ($360 / 12$)
            // Use hours \% 12 for 12-hour clock
            const hoursDegrees = ((hours % 12) / 12) * 360 + ((minutes/60)*30);
            hourHand.style.transform = `rotate(${hoursDegrees}deg)`;
        }
        
        // --- CALCULATOR LOGIC ---

        /**
         * Updates the display with the current input or result.
         */
        function updateDisplay() {
            expressionOutputElement.textContent = expression;
            
            if (expression === "") {
                currentValueElement.textContent = '0';
            } else {
                // Heuristic to show only the last number or operator if the expression is long
                // This improves readability in the limited display space.
                const lastPartMatch = expression.match(/([0-9.]+)?$/);
                const lastPart = lastPartMatch ? lastPartMatch[0] : '';
                currentValueElement.textContent = lastPart || expression; 
            }
        }

        /**
         * Appends a number or operator to the expression.
         * @param {string} value The button value.
         */
        function press(value) {
            // Check if the value is a number (from petal or seed)
            if (!isNaN(parseFloat(value)) || value === '.') {
                expression += value;
            } 
            // Check if the value is an operator or parenthesis
            else if (['+', '-', '*', '/', '(', ')'].includes(value)) {
                // Simple operator logic to prevent double operators
                const lastChar = expression.slice(-1);
                if (['+', '-', '*', '/'].includes(value)) {
                    if (!['+', '-', '*', '/', '(', ''].includes(lastChar)) {
                        expression += value;
                    }
                } else {
                    expression += value;
                }
            } 
            
            updateDisplay();
        }

        /**
         * Deletes the last character from the expression.
         */
        function backspace() {
            expression = expression.slice(0, -1);
            updateDisplay();
        }

        /**
         * Calculates the result of the current expression.
         */
        function equals() {
            try {
                // Ensure * and / are used for evaluation
                const safeExpression = expression.replace(/ร/g, '*').replace(/รท/g, '/'); 
                
                // Use Function constructor for safe dynamic expression evaluation
                const result = new Function('return ' + safeExpression)();
                
                // Format the result to a maximum of 10 decimal places to prevent float issues
                const formattedResult = parseFloat(result.toFixed(10)).toString();

                expressionOutputElement.textContent = expression + " ="; // Show full calculation
                currentValueElement.textContent = formattedResult;
                expression = formattedResult; // Set the result as the new expression to continue calculating

            } catch (e) {
                if (e instanceof SyntaxError) {
                    showErrorModal("Invalid input or incomplete equation. Check your parentheses and operators.");
                } else if (e.message.includes("division by zero")) {
                    showErrorModal("A busy bee can't divide by zero petals! The hive demands numbers.");
                } else {
                    showErrorModal("That calculation wilted! Please check your syntax.");
                }
                clearDisplay(); // Clear on error
            }
        }

        /**
         * Clears the display and the expression.
         */
        function clearDisplay() {
            expression = "";
            currentValueElement.textContent = '0';
            expressionOutputElement.textContent = '';
        }
        
        /**
         * Shows the custom error modal with a message.
         * @param {string} message The error message to display.
         */
        function showErrorModal(message) {
            errorMessageElement.textContent = message;
            errorModal.classList.remove('hidden');
        }

        /**
         * Hides the custom error modal and clears the calculator.
         */
        function hideErrorModal() {
            errorModal.classList.add('hidden');
            clearDisplay();
        }

        // Initialize the display and start the clock on load
        document.addEventListener('DOMContentLoaded', () => {
            updateDisplay();
            updateTime();
            // Start the clock timer
            setInterval(updateTime, 1000); 
        });
    </script>
</body>
</html>
